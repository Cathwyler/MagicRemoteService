namespace MagicRemoteService {

	static class SystemCursor {

		private static readonly System.IntPtr hInvisibleCursor = WinApi.User32.CreateCursor(System.IntPtr.Zero, 0, 0, 32, 32, new byte[]
		{
			0xFF, 0xFF, 0xFF, 0xFF,   // line 1 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 2 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 3 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 4 
 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 5 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 6 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 7 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 8 
 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 9 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 10 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 11 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 12 
 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 13 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 14 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 15 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 16 
 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 17 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 18 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 19 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 20 
 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 21 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 22 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 23 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 24 
 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 25 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 26 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 27 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 28 
 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 29 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 30 
			0xFF, 0xFF, 0xFF, 0xFF,   // line 31 
			0xFF, 0xFF, 0xFF, 0xFF	// line 32 
		}, new byte[]
		{
			0x00, 0x00, 0x00, 0x00,   // line 1 
			0x00, 0x00, 0x00, 0x00,   // line 2 
			0x00, 0x00, 0x00, 0x00,   // line 3 
			0x00, 0x00, 0x00, 0x00,   // line 4 
 
			0x00, 0x00, 0x00, 0x00,   // line 5 
			0x00, 0x00, 0x00, 0x00,   // line 6 
			0x00, 0x00, 0x00, 0x00,   // line 7 
			0x00, 0x00, 0x00, 0x00,   // line 8 
 
			0x00, 0x00, 0x00, 0x00,   // line 9 
			0x00, 0x00, 0x00, 0x00,   // line 10 
			0x00, 0x00, 0x00, 0x00,   // line 11 
			0x00, 0x00, 0x00, 0x00,   // line 12 
 
			0x00, 0x00, 0x00, 0x00,   // line 13 
			0x00, 0x00, 0x00, 0x00,   // line 14 
			0x00, 0x00, 0x00, 0x00,   // line 15 
			0x00, 0x00, 0x00, 0x00,   // line 16 
 
			0x00, 0x00, 0x00, 0x00,   // line 17 
			0x00, 0x00, 0x00, 0x00,   // line 18 
			0x00, 0x00, 0x00, 0x00,   // line 19 
			0x00, 0x00, 0x00, 0x00,   // line 20 
 
			0x00, 0x00, 0x00, 0x00,   // line 21 
			0x00, 0x00, 0x00, 0x00,   // line 22 
			0x00, 0x00, 0x00, 0x00,   // line 23 
			0x00, 0x00, 0x00, 0x00,   // line 24 
 
			0x00, 0x00, 0x00, 0x00,   // line 25 
			0x00, 0x00, 0x00, 0x00,   // line 26 
			0x00, 0x00, 0x00, 0x00,   // line 27 
			0x00, 0x00, 0x00, 0x00,   // line 28 
 
			0x00, 0x00, 0x00, 0x00,   // line 29 
			0x00, 0x00, 0x00, 0x00,   // line 30 
			0x00, 0x00, 0x00, 0x00,   // line 31 
			0x00, 0x00, 0x00, 0x00	// line 32 
		});

		private static System.Collections.Generic.IDictionary<WinApi.CursorName, System.IntPtr> dSystemCursor = new System.Collections.Generic.Dictionary<WinApi.CursorName, System.IntPtr>();

		public static void HideSytemCursor() {
			foreach(WinApi.CursorName cnCursorName in (WinApi.CursorName[])System.Enum.GetValues(typeof(WinApi.CursorName))) {
				if(!MagicRemoteService.SystemCursor.dSystemCursor.ContainsKey(cnCursorName)) {
					MagicRemoteService.SystemCursor.dSystemCursor.Add(cnCursorName, WinApi.User32.CopyIcon(WinApi.User32.LoadCursor(System.IntPtr.Zero, (int)cnCursorName)));
				}
				WinApi.User32.SetSystemCursor(WinApi.User32.CopyIcon(MagicRemoteService.SystemCursor.hInvisibleCursor), (uint)cnCursorName);
			}
		}
		public static void ShowSytemCursor() {
			foreach(WinApi.CursorName cnCursorName in (WinApi.CursorName[])System.Enum.GetValues(typeof(WinApi.CursorName))) {
				if(MagicRemoteService.SystemCursor.dSystemCursor.ContainsKey(cnCursorName)) {
					WinApi.User32.SetSystemCursor(MagicRemoteService.SystemCursor.dSystemCursor[cnCursorName], (uint)cnCursorName);
					MagicRemoteService.SystemCursor.dSystemCursor.Remove(cnCursorName);
				}
			}
		}
	}
}
